if(Object_ID('dbo.Temp_Dictionary_dbo_OrganisationDescendent') is not null)
	drop table dbo.Temp_Dictionary_dbo_OrganisationDescendent
GO
CREATE TABLE [dbo].[Temp_Dictionary_dbo_OrganisationDescendent](
	Id int IDENTITY(1,1) NOT NULL,
	[ParentPath] [varchar](500) NULL,
	[ParentId] int NULL,
	RowNumber int NULL,
	OdsHierarchy hierarchyid NULL,
	[SK_OrganisationID_Root] [int]  NULL,
	[OrganisationCode_Root] [varchar](15)  NULL,
	[OrganisationPrimaryRole_Root] [varchar](5) NULL,
	[SK_OrganisationID_Parent] [int]  NULL,
	[OrganisationCode_Parent] [varchar](15)  NULL,
	[OrganisationPrimaryRole_Parent] [varchar](5) NULL,
	[SK_OrganisationID_Child] [int]  NULL,
	[OrganisationCode_Child] [varchar](15)  NULL,
	[OrganisationPrimaryRole_Child] [varchar](5) NULL,
	[RelationshipType] [varchar](5)  NULL,
	[RelationshipStartDate] [date]  NULL,
	[RelationshipEndDate] [date]  NULL,
	[Path] [varchar](500)  NULL,
	[Depth] [tinyint]  NULL,
	[PathStartDate] [date]  NULL,
	[PathEndDate] [date]  NULL,
	[DateAdded] [date]  NULL,
	[DateUpdated] [date]  NULL,
	[ODSOrgName] [varchar](25) NULL,
	[IsActive] [bit] NULL Default(0),
) ON [PRIMARY]
GO

Insert into Temp_Dictionary_dbo_OrganisationDescendent (OrganisationCode_Child, OdsHierarchy, IsActive) values ('ROOT',hierarchyid::GetRoot(),1)

INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'NHS', N'RO261', 440024, N'NHS', N'RO261', 440024, N'NHS', N'RO261', N'SELF', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date),'NHS')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'TESTICB1', N'RO261', 440024, N'TESTICB1', N'RO261', 440024, N'TESTICB1', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Integrated Care Board 1')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'TESTICB2', N'RO261', 440024, N'TESTICB2', N'RO261', 440024, N'TESTICB2', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Integrated Care Board 2')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'PCN11', N'RO261', 440024, N'PCN11', N'RO261', 440024, N'PCN11', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN11]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Primary Care Board 11')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'PCN12', N'RO261', 440024, N'PCN12', N'RO261', 440024, N'PCN12', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN12]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Primary Care Board 12')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'PCN21', N'RO261', 440024, N'PCN21', N'RO261', 440024, N'PCN21', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN21]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Primary Care Board 21')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'PCN22', N'RO261', 440024, N'PCN22', N'RO261', 440024, N'PCN22', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN22]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'Primary Care Board 22')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP111', N'RO261', 440024, N'GP111', N'RO261', 440024, N'GP111', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN11]-<-{RE4}-<-[GP111]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 111')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP112', N'RO261', 440024, N'GP112', N'RO261', 440024, N'GP112', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN11]-<-{RE4}-<-[GP112]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 112')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP121', N'RO261', 440024, N'GP121', N'RO261', 440024, N'GP121', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN12]-<-{RE4}-<-[GP121]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 121')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP122', N'RO261', 440024, N'GP122', N'RO261', 440024, N'GP122', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB1]-<-{RE4}-<-[PCN12]-<-{RE4}-<-[GP122]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 122')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP211', N'RO261', 440024, N'GP211', N'RO261', 440024, N'GP211', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN21]-<-{RE4}-<-[GP211]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 211')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP212', N'RO261', 440024, N'GP212', N'RO261', 440024, N'GP212', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN21]-<-{RE4}-<-[GP212]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 212')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP221', N'RO261', 440024, N'GP221', N'RO261', 440024, N'GP221', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN22]-<-{RE4}-<-[GP221]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 221')
INSERT [dbo].[Temp_Dictionary_dbo_OrganisationDescendent] ([SK_OrganisationID_Root], [OrganisationCode_Root], [OrganisationPrimaryRole_Root], [SK_OrganisationID_Parent], [OrganisationCode_Parent], [OrganisationPrimaryRole_Parent], [SK_OrganisationID_Child], [OrganisationCode_Child], [OrganisationPrimaryRole_Child], [RelationshipType], [RelationshipStartDate], [RelationshipEndDate], [Path], [Depth], [PathStartDate], [PathEndDate], [DateAdded], [DateUpdated], [ODSOrgName]) VALUES (440024, N'GP222', N'RO261', 440024, N'GP222', N'RO261', 440024, N'GP222', N'RO261', N'RE4', CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), N'[NHS]-<-{RE4}-<-[TESTICB2]-<-{RE4}-<-[PCN22]-<-{RE4}-<-[GP222]', 0, CAST(N'1900-01-01' AS Date), CAST(N'9999-12-31' AS Date), CAST(N'2024-07-13' AS Date), CAST(N'2024-07-13' AS Date), 'General Practice 222')
GO
